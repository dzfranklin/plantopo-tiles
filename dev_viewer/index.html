<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tile Viewer</title>
  <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css">
  <script src="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js"></script>
  <style>
    body { margin: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }
    #controls {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 1;
      background: white;
      padding: 8px 12px;
      border-radius: 4px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.3);
      font-family: sans-serif;
      font-size: 14px;
    }
    #controls select {
      margin-left: 6px;
      font-size: 14px;
    }
    #zoom {
      margin-left: 12px;
      cursor: pointer;
      user-select: none;
    }
  </style>
</head>
<body>
  <div id="controls">
    <label>Layer:
      <select id="layer-select"></select>
    </label>
    <span id="zoom" title="Click to set zoom"></span>
  </div>
  <div id="map"></div>
  <script>
    const LAYERS = [
      { name: 'OS Leisure', url: '/tilejson/os_leisure.json' },
      { name: 'My Personal Map - B', url: '/tilejson/my-personalb.json' },
    ];

    const select = document.getElementById('layer-select');
    let map;

    function setLayer(layer) {
      if (map.getLayer('tiles')) map.removeLayer('tiles');
      if (map.getSource('tiles')) map.removeSource('tiles');

      map.addSource('tiles', { type: 'raster', url: layer.url });
      map.addLayer({ id: 'tiles', type: 'raster', source: 'tiles' });
    }

    for (const [i, layer] of LAYERS.entries()) {
      const opt = document.createElement('option');
      opt.value = i;
      opt.textContent = layer.name;
      select.appendChild(opt);
    }

    map = new maplibregl.Map({
      container: 'map',
      style: { version: 8, sources: {}, layers: [] },
      center: [-3.5, 55.4],
      zoom: 6,
      hash: true,
    });

    const zoomEl = document.getElementById('zoom');
    function updateZoom() {
      zoomEl.textContent = 'z' + map.getZoom().toFixed(1);
    }
    map.on('zoom', updateZoom);
    updateZoom();

    zoomEl.addEventListener('click', () => {
      const z = prompt('Zoom level:', map.getZoom().toFixed(1));
      if (z !== null && !isNaN(z)) map.setZoom(Number(z));
    });

    map.addControl(new maplibregl.NavigationControl(), 'top-right');

    map.on('load', () => {
      setLayer(LAYERS[0]);
    });

    select.addEventListener('change', () => {
      setLayer(LAYERS[select.value]);
    });
  </script>
</body>
</html>
